SELECT 
    order_date,
    product_id,
    AVG(quantity) OVER (PARTITION BY product_id ORDER BY order_date RANGE BETWEEN INTERVAL '7 days' PRECEDING AND CURRENT ROW) AS rolling_avg_quantity
FROM 
    order_items oi
JOIN 
    orders o ON oi.order_id = o.order_id;
